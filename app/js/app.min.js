document.addEventListener("DOMContentLoaded",(function(){let e=window.localStorage,t=document.getElementById("table"),n=document.getElementById("delete"),l=document.getElementById("clear"),r=[],d=0;l.onclick=e=>{r=[];let n=t.getElementsByTagName("tr");for(let e=0;e<n.length;e++){let t=n.item(e);t.removeAttribute("style"),t.removeAttribute("selected")}},n.onclick=n=>{r=[];let l=[],d=t.getElementsByTagName("tr");for(let t=0;t<d.length;t++){let n=d.item(t);null!==n.getAttribute("selected")&&(console.log(t),l.push(n),e.removeItem(s(n)),e.removeItem(c(n)),e.removeItem(i(n)))}l.forEach(e=>{t.removeChild(e)}),1===d.length&&o()};let o=()=>{let e=document.getElementById("container");e.removeChild(t);let r=document.createElement("div"),d=document.createElement("h2");r.appendChild(d),d.innerText="There`s no info... Add some!",e.appendChild(r),n.setAttribute("disabled",""),l.setAttribute("disabled","")},a=e=>t.getElementsByTagName("tr")[parseInt(e)+1],m=(e,t)=>e.getElementsByTagName("td")[t],i=e=>m(e,0).innerText,c=e=>m(e,2).innerText,s=e=>m(e,1).innerText,u=(t,n,l)=>{let r=t.target,d=a(l),o=m(d,n),u=r.value,g=o.getAttribute("key");u.length>0&&(((t,n,l)=>{switch(n){case"full_name":{let n=s(l);e.setItem(n,t);break}case"address":{let n=i(l);e.setItem(n,t);break}case"phone":{let n=c(l);e.setItem(n,t);break}}})(u,g,d),o.removeChild(r),o.innerText=u)},g=e=>{let n=document.createElement("tr");n.onclick=e=>{(e=>{let t=e.currentTarget,n=t.getAttribute("selected"),l=t.style,d=t.getElementsByTagName("td")[0].getAttribute("vertIndex");null===n?(l.backgroundColor="blue",t.setAttribute("selected",""),r.push(d)):(l.backgroundColor="transparent",t.removeAttribute("selected"),r=r.filter(e=>e!==d))})(e)},Object.keys(e).forEach((t,l)=>{let r=document.createElement("td");r.innerText=e[t],r.setAttribute("horIndex",l),r.setAttribute("vertIndex",d),r.setAttribute("key",t),r.ondblclick=e=>{(e=>{let t=e.target,n=t.getAttribute("vertIndex"),l=t.getAttribute("horIndex"),r=document.createElement("input");r.value=t.innerText,r.onblur=e=>{u(e,l,n)},t.innerText="",t.appendChild(r),r.focus()})(e)},n.appendChild(r)}),t.appendChild(n),d++};(()=>{let t=Object.keys(e).sort((e,t)=>t.length-e.length);for(let n=0;n<e.length/3;n++){let l=t[n],r=e[l],d=e[r];g({full_name:d,phone:r,address:l})}0===d&&o()})()}));