document.addEventListener("DOMContentLoaded",(function(){let e=window.localStorage,t=document.getElementById("table"),n=document.getElementById("delete"),l=document.getElementById("clear"),r=document.getElementById("add"),d=document.getElementsByTagName("body").item(0),i=document.getElementsByTagName("header").item(0),a=document.getElementsByTagName("main").item(0),o=[],m=0;l.onclick=e=>{o=[];let n=t.getElementsByTagName("tr");for(let e=0;e<n.length;e++){let t=n.item(e);t.removeAttribute("style"),t.removeAttribute("selected")}},n.onclick=n=>{o=[];let l=[],r=t.getElementsByTagName("tr");for(let t=0;t<r.length;t++){let n=r.item(t);null!==n.getAttribute("selected")&&(console.log(t),l.push(n),e.removeItem(h(n)),e.removeItem(p(n)),e.removeItem(g(n)))}l.forEach(e=>{t.removeChild(e)}),1===r.length&&s()};r.onclick=e=>{let t=document.createElement("div"),n=t.style;n.position="absolute",n.backgroundColor="red",n.top="0",n.right="0",n.zIndex=15,n.width="100%",n.height="100%",n.backgroundColor="transparent",n.display="flex",n.flexDirection="column",n.justifyContent="center",n.alignItems="center";let l=document.createElement("form"),r=document.createElement("span");r.setAttribute("className","heading"),r.innerText="Add new info",l.appendChild(r),l.style.backgroundColor="white",l.style.display="flex",l.style.flexDirection="column",l.style.justifyContent="center",l.style.alignContent="center";let o=document.createElement("input");o.setAttribute("id","full_name"),l.appendChild(o),o=document.createElement("input"),o.setAttribute("id","phone"),l.appendChild(o),o=document.createElement("input"),o.setAttribute("id","address"),l.appendChild(o),l.focus(),l.onmouseleave=e=>{((e,t)=>{d.removeChild(t),a.style.filter="",i.style.filter=""})(0,t)};let m=document.createElement("button");m.innerText="Add",l.appendChild(m),t.appendChild(l),a.style.transition="0.7s all linear",a.style.filter="blur(10px)",i.style.transition="0.7s all linear",i.style.filter="blur(10px)",d.appendChild(t)};let s=()=>{let e=document.getElementById("container");e.removeChild(t);let r=document.createElement("div"),d=document.createElement("h2");r.appendChild(d),d.innerText="There`s no info... Add some!",e.appendChild(r),n.setAttribute("disabled",""),l.setAttribute("disabled","")},c=e=>t.getElementsByTagName("tr")[parseInt(e)+1],u=(e,t)=>e.getElementsByTagName("td")[t],g=e=>u(e,0).innerText,p=e=>u(e,2).innerText,h=e=>u(e,1).innerText,b=(t,n,l)=>{let r=t.target,d=c(l),i=u(d,n),a=r.value,o=i.getAttribute("key");a.length>0&&(((t,n,l)=>{switch(n){case"full_name":{let n=h(l);e.setItem(n,t);break}case"address":{let n=g(l);e.setItem(n,t);break}case"phone":{let n=p(l);e.setItem(n,t);break}}})(a,o,d),i.removeChild(r),i.innerText=a)},y=e=>{let n=document.createElement("tr");n.onclick=e=>{(e=>{let t=e.currentTarget,n=t.getAttribute("selected"),l=t.style,r=t.getElementsByTagName("td")[0].getAttribute("vertIndex");null===n?(l.backgroundColor="blue",t.setAttribute("selected",""),o.push(r)):(l.backgroundColor="transparent",t.removeAttribute("selected"),o=o.filter(e=>e!==r))})(e)},Object.keys(e).forEach((t,l)=>{let r=document.createElement("td");r.innerText=e[t],r.setAttribute("horIndex",l),r.setAttribute("vertIndex",m),r.setAttribute("key",t),r.ondblclick=e=>{(e=>{let t=e.target,n=t.getAttribute("vertIndex"),l=t.getAttribute("horIndex"),r=document.createElement("input");r.value=t.innerText,r.onblur=e=>{b(e,l,n)},t.innerText="",t.appendChild(r),r.focus()})(e)},n.appendChild(r)}),t.appendChild(n),m++};(()=>{let t=Object.keys(e).sort((e,t)=>t.length-e.length);for(let n=0;n<e.length/3;n++){let l=t[n],r=e[l],d=e[r];y({full_name:d,phone:r,address:l})}0===m&&s()})()}));